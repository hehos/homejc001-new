function move(e,t){clearInterval(e.timer),e.timer=setInterval(function(){var o=(t-e.offsetTop)/10;e.offsetTop==t?clearInterval(e.timer):e.style.top=e.offsetTop+o+"px"},30)}function next(){iTar>num&&num>=0&&(num++,move(oUl,-num*liUseHeight))}function prev(){iTar>=num&&num>0&&(num--,move(oUl,-num*liUseHeight))}function bigPrev(){if(oPrevCurrent)var e=oPrevCurrent.getAttribute("href");window.location.href=e}function bigNext(){if(oNextCurrent)var e=oNextCurrent.getAttribute("href");window.location.href=e}function allEvent(){document.onkeydown=keydownFunc,oListImg.addEventListener&&oListImg.addEventListener("DOMMouseScroll",scrollFunc,!1),oListImg.onmousewheel=scrollFunc,oNext.onclick=next,oPrev.onclick=prev,oPrevSpan.onclick=bigPrev,oNextSpan.onclick=bigNext}function keydownFunc(e){var t=keyFunc(e);switch(t){case 37:bigPrev();break;case 38:prev();break;case 39:bigNext();break;case 40:next()}(e||window.event).preventDefault()}function onkeydownCancel(){document.onkeydown=function(e){var t=keyFunc(e);(40==t||38==t)&&0==t.returnValue}}function scrollFunc(e){e=e||window.event,e.wheelDelta?e.wheelDelta<0?next():prev():e.detail&&(e.detail<0?prev():next()),onmousewheelDisabled(!1),e.preventDefault()}function scrollFunc_big(e){e=e||window.event,e.wheelDelta?e.wheelDelta<0?bigNext():bigPrev():e.detail&&(e.detail<0?bigPrev():bigNext()),onmousewheelDisabled(!1),e.preventDefault()}function keyFunc(e){var e=e||event;return e.keyCode||e.which||e.charCode}function onmousewheelDisabled(e){oListImg.addEventListener&&document.body.addEventListener("DOMMouseScroll",function(){return e}),document.onmousewheel=function(){return e}}function getBystyle(e,t){return e.currentStyle?e.currentStyle[t]:getComputedStyle(e,!1)[t]}var oPhoto=document.getElementById("photo"),oBigImg=oPhoto.getElementsByTagName("div")[0],oListImg=document.getElementById("listImg"),oImgDiv=oListImg.getElementsByTagName("div")[0],oPrev=oListImg.getElementsByTagName("p")[0],oNext=oListImg.getElementsByTagName("p")[1],oPrevCurrent=document.getElementById("ImgPrev"),oNextCurrent=document.getElementById("ImgNext"),oPrevSpan=oBigImg.getElementsByTagName("span")[0],oNextSpan=oBigImg.getElementsByTagName("span")[1],oUl=oListImg.getElementsByTagName("ul")[0],oLis=oUl.getElementsByTagName("li"),showNum=5,num=0,i,len=oLis.length,liMargin=3,showHeightVal=parseInt(getBystyle(oListImg,"height")),showHeight=showHeightVal-oPrev.offsetHeight-oNext.offsetHeight,liHeight=(showHeight-liMargin*(showNum+1))/showNum;oUl.style.height=(liHeight+liMargin)*len+liMargin+"px",oImgDiv.style.height=showHeight+"px";var liUseHeight=liHeight+liMargin,iTar=len-showNum;oPrevSpan.style.height=oBigImg.offsetHeight+"px",oNextSpan.style.height=oBigImg.offsetHeight+"px";var bigBtnOffsetTop=(oBigImg.offsetHeight-(oPrevCurrent||oNextCurrent).offsetHeight)/2+"px";for(oPrevCurrent.style.top=oNextCurrent.style.top=bigBtnOffsetTop,oPrevCurrent&&(oPrevSpan.style.display="inline-block"),oNextCurrent&&(oNextSpan.style.display="inline-block"),oPrevSpan.onmousemove=function(){oPrevCurrent.style.visibility="visible"},oPrevSpan.onmouseout=function(){oPrevCurrent.style.visibility="hidden"},oNextSpan.onmousemove=function(){oNextCurrent.style.visibility="visible"},oNextSpan.onmouseout=function(){oNextCurrent.style.visibility="hidden"},i=0;len>i;i++){oLis[i].style.height=liHeight+"px",oLis[i].style.margin=liMargin+"px 0";var liClassName=oLis[i].className,moveZeroNum=parseInt(showNum/2);if(liClassName.match("on")&&i>moveZeroNum&&len>showNum){var moveNum=0;len-i>moveZeroNum?(moveNum=i-moveZeroNum,oUl.style.top=-moveNum*liUseHeight+"px"):(moveNum=iTar,oUl.style.top=-moveNum*liUseHeight+"px"),num=moveNum}}oPhoto.onmouseover=allEvent,oPhoto.onmouseout=function(){onkeydownCancel(),onmousewheelDisabled(!0)};